---
 - hosts: all
   become: True
   tasks:
    - name: Add centos os repositories
      yum_repository:
        name: os
        description: os repositories
        file: rhel_extra_hard
        baseurl: http://mirror.centos.org/centos/7/os/x86_64/
        gpgcheck: no

    - name: installing docker dependencies
      yum:
       name: https://rpmfind.net/linux/centos/7.6.1810/extras/x86_64/Packages/container-selinux-2.74-1.el7.noarch.rpm
       state: present

    - name: Add centos extras repositories
      yum_repository:
        name: epel
        description: extras repositories
        file: rhel_extra_hard
        baseurl: http://mirror.centos.org/centos/7/extras/x86_64/
        gpgcheck: no

    - name: Getting docker-ce repository
      get_url:
       url: https://download.docker.com/linux/centos/docker-ce.repo
       dest: /etc/yum.repos.d/

    - name: installing docker-py for python
      yum:
       name: http://mirror.centos.org/centos/7/extras/x86_64/Packages/python-docker-py-1.10.6-8.el7_6.noarch.rpm
       state: present

    - name: installing docker
      yum:
       name: docker-ce
       state: present

    - name: installing firewalld so it can be access from anywhere
      yum:
       name: firewalld
       state: present

    - name: enable and restart firewalld service
      service:
       name: firewalld
       state: restarted
       enabled: yes

    - name: enable and restart docker service
      service:
       name: docker
       state: restarted
       enabled: yes

